# SPDX-License-Identifier: GPL-3.0-only
CC=clang
CFLAGS=-I. -O2
#-fPIE -pie

all: break_kaslr retbleed

break_kaslr: break_kaslr.c retbleed.h
	$(CC) -o $@ $(CFLAGS) $<

retbleed: retbleed.c retbleed.h
	$(CC) -o $@ -lpthread $(CFLAGS) $<

# retbleed: retbleed.c retbleed.h
#     $(CC) -DCPUA=0 -DCPUB=6 -o $@_0 -lpthread $(CFLAGS) $<
#     $(CC) -DCPUA=1 -DCPUB=7 -o $@_1 -lpthread $(CFLAGS) $<
#     $(CC) -DCPUA=2 -DCPUB=8 -o $@_2 -lpthread $(CFLAGS) $<
#     $(CC) -DCPUA=3 -DCPUB=9 -o $@_3 -lpthread $(CFLAGS) $<
#     $(CC) -DCPUA=4 -DCPUB=10 -o $@_4 -lpthread $(CFLAGS) $<
#     $(CC) -DCPUA=5 -DCPUB=11 -o $@_5 -lpthread $(CFLAGS) $<

clean:
	rm -f break_kaslr retbleed
